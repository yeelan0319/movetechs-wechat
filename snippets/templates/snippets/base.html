<!DOCTYPE html>
<html>
  <head>
    <title>定期总结与及时沟通</title>
    {% load static %}
    <link rel="stylesheet" href="{% static "material-components-web/dist/material-components-web.css" %}">
    <link rel="stylesheet" href="{% static "material-icons.css" %}">
    <style>
      body {
        margin: 0 24px;
      }
      main {
        padding-top: 24px;
      }
      ul, li {
        margin: 0;
        padding: 0;
      }
      .mdc-toolbar__title {
        color: white;
      }
      .mdc-tab {
        font-weight: bold;
        color: #222;
        min-width: 100px;
      }
      .mdc-tab.has_read {
        font-weight: normal;
      }
      .mdc-tab.is_done {
        font-weight: normal;
        color: #BDBDBD;
      }
      .snippet-card {
        position: relative;
        margin: 16px auto;
        max-width: 1024px;
        padding-top: 16px;
      }
      .snippet-content {
        min-height: 300px;
      }
      .snippet-card-hide {
        display: none;
      }
      .mdc-card__supporting-text {
        padding-left: 48px;
      }
      .snippet-star {
        position: absolute;
        top: 24px;
        left: 16px;
        cursor: pointer;
        transition: all 0.5s ease;
      }
      .snippet-star:hover {
        color: #999;
      }
      .week-indicator {
        padding: 16px;
      }
    </style>
  </head>
  <body class="mdc-typography">
    <header class="mdc-toolbar mdc-toolbar--fixed">
      <div class="mdc-toolbar__row">
        {% block title %}{% endblock %}
      </div>
    </header>
    <main class="mdc-toolbar-fixed-adjust">
      {% block content %}{% endblock %}
    </main>
    <script src="{% static "material-components-web/dist/material-components-web.js" %}"></script>
    <script>
      var toolbar = mdc.toolbar.MDCToolbar.attachTo(document.querySelector('.mdc-toolbar'));
      toolbar.fixedAdjustElement = document.querySelector('.mdc-toolbar-fixed-adjust');
    </script>
    <script type="text/javascript">
    function show(id) {
      var snippetCards = document.querySelectorAll('.snippet-card');
      for (var i = 0; i < snippetCards.length; i++) {
        snippetCards[i].classList.add('snippet-card-hide');
      }

      var xmlhttp = new XMLHttpRequest();
      xmlhttp.onreadystatechange = function() {
          if (xmlhttp.readyState == XMLHttpRequest.DONE) {   // XMLHttpRequest.DONE == 4
            if (xmlhttp.status == 200) {
              document.querySelector('#snippet-tab-' + id).classList.add('has_read');
            } else {
              console.log('something else other than 200 was returned');
            }
          }
      };
      xmlhttp.open('GET', '/snippets/read/' + id, true);
      xmlhttp.send();

      document.querySelector('#snippet-card-' + id).classList.remove('snippet-card-hide');
    }

    function toogle_star(id) {
      star_el = document.querySelector('#snippet-card-' + id  + ' .snippet-star');
      has_star = star_el.innerText === 'star';

      var xmlhttp = new XMLHttpRequest();
      xmlhttp.onreadystatechange = function() {
          if (xmlhttp.readyState == XMLHttpRequest.DONE) {   // XMLHttpRequest.DONE == 4
            if (xmlhttp.status == 200) {
              star_el.innerText = has_star? 'star_border' : 'star';
            } else {
              console.log('something else other than 200 was returned');
            }
          }
      };
      url_prefix = (has_star? '/snippets/unstar/' : '/snippets/star/');
      xmlhttp.open('GET', url_prefix + id, true);
      xmlhttp.send();
    }
  </script>
  </body>
</html>